<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                             http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
         version="4.0">

  <display-name>Student Management System</display-name>
  <description>Java Servlet and JSP based Student Registration and Management System</description>

  <!--  Context Parameters  -->
  <context-param>
    <param-name>upload.location</param-name>
    <param-value>/uploads</param-value>
  </context-param>

  <context-param>
    <param-name>max.file.size</param-name>
    <param-value>5242880</param-value>
    <!--  5MB  -->
  </context-param>

  <!--  Session Configuration  -->
  <session-config>
    <session-timeout>30</session-timeout>
    <!--  30 minutes  -->
    <cookie-config>
      <http-only>true</http-only>
      <secure>false</secure>
      <!--  Set to true in production with HTTPS  -->
    </cookie-config>
  </session-config>

  <!--  Welcome File List  -->
  <welcome-file-list>
    <!-- forward to /login servlet (mapped below) -->
    <welcome-file>login</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>index.html</welcome-file>
  </welcome-file-list>

  <!--  Error Pages  -->
  <error-page>
    <error-code>404</error-code>
    <location>/WEB-INF/views/error.jsp</location>
  </error-page>

  <error-page>
    <error-code>500</error-code>
    <location>/WEB-INF/views/error.jsp</location>
  </error-page>

  <error-page>
    <exception-type>java.lang.Exception</exception-type>
    <location>/WEB-INF/views/error.jsp</location>
  </error-page>

  <!--  Security Constraints  -->
  <!-- <security-constraint>
    <web-resource-collection>
      <web-resource-name>Protected Area</web-resource-name>
      <url-pattern>/student/*</url-pattern>
      <url-pattern>/admin/*</url-pattern>
      <http-method>GET</http-method>
      <http-method>POST</http-method>
    </web-resource-collection>
    <auth-constraint>
      <role-name>STUDENT</role-name>
      <role-name>ADMIN</role-name>
    </auth-constraint>
  </security-constraint> -->
  <!-- Declare roles used by security-constraint (prevents Tomcat warnings) -->
  <security-role>
    <role-name>STUDENT</role-name>
  </security-role>
  <security-role>
    <role-name>ADMIN</role-name>
  </security-role>

  <!-- Explicit mapping for LoginServlet (ensures /login is registered) -->
  <servlet>
    <servlet-name>LoginServlet</servlet-name>
    <servlet-class>com.studentmanagement.servlet.LoginServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>LoginServlet</servlet-name>
    <url-pattern>/login</url-pattern>
  </servlet-mapping>

  <!-- Explicit mapping for LogoutServlet -->
  <servlet>
    <servlet-name>LogoutServlet</servlet-name>
    <servlet-class>com.studentmanagement.servlet.LogoutServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>LogoutServlet</servlet-name>
    <url-pattern>/logout</url-pattern>
  </servlet-mapping>

  <!-- If you have other important servlets you want guaranteed, add mappings here,
       e.g. AdminDashboardServlet, StudentDashboardServlet, ReportServlet, etc. -->

  <!--  MIME Type Mappings  -->
  <mime-mapping>
    <extension>pdf</extension>
    <mime-type>application/pdf</mime-type>
  </mime-mapping>

  <mime-mapping>
    <extension>jpg</extension>
    <mime-type>image/jpeg</mime-type>
  </mime-mapping>

  <mime-mapping>
    <extension>png</extension>
    <mime-type>image/png</mime-type>
  </mime-mapping>

  <mime-mapping>
    <extension>xls</extension>
    <mime-type>application/vnd.ms-excel</mime-type>
  </mime-mapping>

  <mime-mapping>
    <extension>xlsx</extension>
    <mime-type>application/vnd.openxmlformats-officedocument.spreadsheetml.sheet</mime-type>
  </mime-mapping>

  <mime-mapping>
    <extension>csv</extension>
    <mime-type>text/csv</mime-type>
  </mime-mapping>

</web-app>
